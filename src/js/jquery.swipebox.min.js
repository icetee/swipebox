!function(window,document,$,undefined){$.swipebox=function(elem,options){var ui,$elem,defaults={useCSS:!0,useSVG:!0,initialIndexOnArray:0,removeBarsOnMobile:!0,hideCloseButtonOnMobile:!1,hideBarsDelay:3e3,videoMaxWidth:1140,vimeoColor:"cccccc",beforeOpen:null,afterOpen:null,title:null,afterClose:null,loopAtEnd:!1,autoplayVideos:!1,queryStringData:{},toggleClassOnLoad:""},plugin=this,elements=[],isMobile=navigator.userAgent.match(/(iPad)|(iPhone)|(iPod)|(Android)|(PlayBook)|(BB10)|(BlackBerry)|(Opera Mini)|(IEMobile)|(webOS)|(MeeGo)/i),isTouch=null!==isMobile||document.createTouch!==undefined||"ontouchstart"in window||"onmsgesturechange"in window||navigator.msMaxTouchPoints,supportSVG=!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect,winWidth=window.innerWidth?window.innerWidth:$(window).width(),winHeight=window.innerHeight?window.innerHeight:$(window).height(),currentX=0,html='<div id="swipebox-overlay">					<div id="swipebox-container">						<div id="swipebox-slider"></div>						<div id="swipebox-top-bar">							<div id="swipebox-title"></div>						</div>						<div id="swipebox-bottom-bar">							<div id="swipebox-arrows">								<a id="swipebox-prev"></a>								<a id="swipebox-next"></a>							</div>						</div>						<a id="swipebox-close"></a>					</div>			</div>';plugin.settings={},$.swipebox.close=function(){ui.closeSlide()},$.swipebox.extend=function(){return ui},plugin.init=function(){plugin.settings=$.extend({},defaults,options),$.isArray(elem)?(elements=elem,ui.target=$(window),ui.init(plugin.settings.initialIndexOnArray)):$(elem).on("click",function(event){if("slide current"===event.target.parentNode.className)return!1;$.isArray(elem)||(ui.destroy(),$elem=$(elem),ui.actions()),elements=[];var index,relType,relVal;relVal||(relType="data-rel",relVal=$(this).attr(relType)),relVal||(relType="rel",relVal=$(this).attr(relType)),$elem=$(relVal&&""!==relVal&&"nofollow"!==relVal?"["+relType+'="'+relVal+'"]':elem),$elem.each(function(){var $this=$(this),href=$this.attr("href")||null,title=$this.attr("data-title")||$this.attr("title")||plugin.settings.title;elements.push({href:href,title:title})}),index=$elem.index($(this)),event.preventDefault(),event.stopPropagation(),ui.target=$(event.target),ui.init(index)})},ui={init:function(index){plugin.settings.beforeOpen&&plugin.settings.beforeOpen(),this.target.trigger("swipebox-start"),$.swipebox.isOpen=!0,this.build(),this.openSlide(index),this.openMedia(index),this.preloadMedia(index+1),this.preloadMedia(index-1),plugin.settings.afterOpen&&plugin.settings.afterOpen()},build:function(){var bg,$this=this;$("body").append(html),supportSVG&&plugin.settings.useSVG===!0&&(bg=$("#swipebox-close").css("background-image"),bg=bg.replace("png","svg"),$("#swipebox-prev, #swipebox-next, #swipebox-close").css({"background-image":bg})),isMobile&&plugin.settings.removeBarsOnMobile&&$("#swipebox-bottom-bar, #swipebox-top-bar").remove(),$.each(elements,function(){$("#swipebox-slider").append('<div class="slide"></div>')}),$this.setDim(),$this.actions(),isTouch&&$this.gesture(),$this.keyboard(),$this.animBars(),$this.resize()},setDim:function(){var width,height,sliderCss={};"onorientationchange"in window?window.addEventListener("orientationchange",function(){0===window.orientation?(width=winWidth,height=winHeight):(90===window.orientation||-90===window.orientation)&&(width=winHeight,height=winWidth)},!1):(width=window.innerWidth?window.innerWidth:$(window).width(),height=window.innerHeight?window.innerHeight:$(window).height()),sliderCss={width:width,height:height},$("#swipebox-overlay").css(sliderCss)},resize:function(){var $this=this;$(window).resize(function(){$this.setDim()}).resize()},supportTransition:function(){var i,prefixes="transition WebkitTransition MozTransition OTransition msTransition KhtmlTransition".split(" ");for(i=0;i<prefixes.length;i++)if(document.createElement("div").style[prefixes[i]]!==undefined)return prefixes[i];return!1},doCssTrans:function(){return plugin.settings.useCSS&&this.supportTransition()?!0:void 0},gesture:function(){var index,hDistance,vDistance,hDistanceLast,vDistanceLast,hDistancePercent,$this=this,vSwipe=!1,hSwipe=!1,hSwipMinDistance=10,vSwipMinDistance=50,startCoords={},endCoords={},bars=$("#swipebox-top-bar, #swipebox-bottom-bar"),slider=$("#swipebox-slider");bars.addClass("visible-bars"),$this.setTimeout(),$("body").bind("touchstart",function(event){return $(this).addClass("touching"),index=$("#swipebox-slider .slide").index($("#swipebox-slider .slide.current")),endCoords=event.originalEvent.targetTouches[0],startCoords.pageX=event.originalEvent.targetTouches[0].pageX,startCoords.pageY=event.originalEvent.targetTouches[0].pageY,$("#swipebox-slider").css({"-webkit-transform":"translate3d("+currentX+"%, 0, 0)",transform:"translate3d("+currentX+"%, 0, 0)"}),$(".touching").bind("touchmove",function(event){if(event.preventDefault(),event.stopPropagation(),endCoords=event.originalEvent.targetTouches[0],!hSwipe&&(vDistanceLast=vDistance,vDistance=endCoords.pageY-startCoords.pageY,Math.abs(vDistance)>=vSwipMinDistance||vSwipe)){var opacity=.75-Math.abs(vDistance)/slider.height();slider.css({top:vDistance+"px"}),slider.css({opacity:opacity}),vSwipe=!0}hDistanceLast=hDistance,hDistance=endCoords.pageX-startCoords.pageX,hDistancePercent=100*hDistance/winWidth,!hSwipe&&!vSwipe&&Math.abs(hDistance)>=hSwipMinDistance&&($("#swipebox-slider").css({"-webkit-transition":"",transition:""}),hSwipe=!0),hSwipe&&(hDistance>0?0===index?$("#swipebox-overlay").addClass("leftSpringTouch"):($("#swipebox-overlay").removeClass("leftSpringTouch").removeClass("rightSpringTouch"),$("#swipebox-slider").css({"-webkit-transform":"translate3d("+(currentX+hDistancePercent)+"%, 0, 0)",transform:"translate3d("+(currentX+hDistancePercent)+"%, 0, 0)"})):0>hDistance&&(elements.length===index+1?$("#swipebox-overlay").addClass("rightSpringTouch"):($("#swipebox-overlay").removeClass("leftSpringTouch").removeClass("rightSpringTouch"),$("#swipebox-slider").css({"-webkit-transform":"translate3d("+(currentX+hDistancePercent)+"%, 0, 0)",transform:"translate3d("+(currentX+hDistancePercent)+"%, 0, 0)"}))))}),!1}).bind("touchend",function(event){if(event.preventDefault(),event.stopPropagation(),$("#swipebox-slider").css({"-webkit-transition":"-webkit-transform 0.4s ease",transition:"transform 0.4s ease"}),vDistance=endCoords.pageY-startCoords.pageY,hDistance=endCoords.pageX-startCoords.pageX,hDistancePercent=100*hDistance/winWidth,vSwipe)if(vSwipe=!1,Math.abs(vDistance)>=2*vSwipMinDistance&&Math.abs(vDistance)>Math.abs(vDistanceLast)){var vOffset=vDistance>0?slider.height():-slider.height();slider.animate({top:vOffset+"px",opacity:0},300,function(){$this.closeSlide()})}else slider.animate({top:0,opacity:1},300);else hSwipe?(hSwipe=!1,hDistance>=hSwipMinDistance&&hDistance>=hDistanceLast?$this.getPrev():-hSwipMinDistance>=hDistance&&hDistanceLast>=hDistance&&$this.getNext()):bars.hasClass("visible-bars")?($this.clearTimeout(),$this.hideBars()):($this.showBars(),$this.setTimeout());$("#swipebox-slider").css({"-webkit-transform":"translate3d("+currentX+"%, 0, 0)",transform:"translate3d("+currentX+"%, 0, 0)"}),$("#swipebox-overlay").removeClass("leftSpringTouch").removeClass("rightSpringTouch"),$(".touching").off("touchmove").removeClass("touching")})},setTimeout:function(){if(plugin.settings.hideBarsDelay>0){var $this=this;$this.clearTimeout(),$this.timeout=window.setTimeout(function(){$this.hideBars()},plugin.settings.hideBarsDelay)}},clearTimeout:function(){window.clearTimeout(this.timeout),this.timeout=null},showBars:function(){var bars=$("#swipebox-top-bar, #swipebox-bottom-bar");this.doCssTrans()?bars.addClass("visible-bars"):($("#swipebox-top-bar").animate({top:0},500),$("#swipebox-bottom-bar").animate({bottom:0},500),setTimeout(function(){bars.addClass("visible-bars")},1e3))},hideBars:function(){var bars=$("#swipebox-top-bar, #swipebox-bottom-bar");this.doCssTrans()?bars.removeClass("visible-bars"):($("#swipebox-top-bar").animate({top:"-50px"},500),$("#swipebox-bottom-bar").animate({bottom:"-50px"},500),setTimeout(function(){bars.removeClass("visible-bars")},1e3))},animBars:function(){var $this=this,bars=$("#swipebox-top-bar, #swipebox-bottom-bar");bars.addClass("visible-bars"),$this.setTimeout(),$("#swipebox-slider").click(function(){bars.hasClass("visible-bars")||($this.showBars(),$this.setTimeout())}),$("#swipebox-bottom-bar").hover(function(){$this.showBars(),bars.addClass("visible-bars"),$this.clearTimeout()},function(){plugin.settings.hideBarsDelay>0&&(bars.removeClass("visible-bars"),$this.setTimeout())})},keyboard:function(){var $this=this;$(window).bind("keyup",function(event){event.preventDefault(),event.stopPropagation(),37===event.keyCode?$this.getPrev():39===event.keyCode?$this.getNext():27===event.keyCode&&$this.closeSlide()})},actions:function(){var $this=this,action="touchend click";elements.length<2?($("#swipebox-bottom-bar").hide(),undefined===elements[1]&&$("#swipebox-top-bar").hide()):($("#swipebox-prev").bind(action,function(event){event.preventDefault(),event.stopPropagation(),$this.getPrev(),$this.setTimeout()}),$("#swipebox-next").bind(action,function(event){event.preventDefault(),event.stopPropagation(),$this.getNext(),$this.setTimeout()})),$("#swipebox-close").bind(action,function(){$this.closeSlide()})},setSlide:function(index,isFirst){isFirst=isFirst||!1;var slider=$("#swipebox-slider");currentX=100*-index,this.doCssTrans()?slider.css({"-webkit-transform":"translate3d("+100*-index+"%, 0, 0)",transform:"translate3d("+100*-index+"%, 0, 0)"}):slider.animate({left:100*-index+"%"}),$("#swipebox-slider .slide").removeClass("current"),$("#swipebox-slider .slide").eq(index).addClass("current"),this.setTitle(index),isFirst&&slider.fadeIn(),$("#swipebox-prev, #swipebox-next").removeClass("disabled"),0===index?$("#swipebox-prev").addClass("disabled"):index===elements.length-1&&plugin.settings.loopAtEnd!==!0&&$("#swipebox-next").addClass("disabled")},openSlide:function(index){$("html").addClass("swipebox-html"),isTouch?($("html").addClass("swipebox-touch"),plugin.settings.hideCloseButtonOnMobile&&$("html").addClass("swipebox-no-close-button")):$("html").addClass("swipebox-no-touch"),$(window).trigger("resize"),this.setSlide(index,!0)},preloadMedia:function(index){var $this=this,src=null;elements[index]!==undefined&&(src=elements[index].href),$this.isVideo(src)?$this.openMedia(index):setTimeout(function(){$this.openMedia(index)},1e3)},openMedia:function(index){var src,slide,$this=this;return elements[index]!==undefined&&(src=elements[index].href),0>index||index>=elements.length?!1:(slide=$("#swipebox-slider .slide").eq(index),void($this.isVideo(src)?slide.html($this.getVideo(src)):(slide.addClass("slide-loading"),$this.loadMedia(src,function(){slide.removeClass("slide-loading"),slide.html(this)}))))},setTitle:function(index){var title=null;$("#swipebox-title").empty(),elements[index]!==undefined&&(title=elements[index].title),title?($("#swipebox-top-bar").show(),$("#swipebox-title").append(title)):$("#swipebox-top-bar").hide()},isVideo:function(src){if(src){if(src.match(/(youtube\.com|youtube-nocookie\.com)\/watch\?v=([a-zA-Z0-9\-_]+)/)||src.match(/vimeo\.com\/([0-9]*)/)||src.match(/youtu\.be\/([a-zA-Z0-9\-_]+)/))return!0;if(src.toLowerCase().indexOf("swipeboxvideo=1")>=0)return!0}},parseUri:function(uri,customData){var a=document.createElement("a"),qs={};return a.href=decodeURIComponent(uri),qs=JSON.parse('{"'+a.search.toLowerCase().replace("?","").replace(/&/g,'","').replace(/=/g,'":"')+'"}'),$.isPlainObject(customData)&&(qs=$.extend(qs,customData,plugin.settings.queryStringData)),$.map(qs,function(val,key){return val&&val>""?encodeURIComponent(key)+"="+encodeURIComponent(val):void 0}).join("&")},getVideo:function(url){var iframe="",youtubeUrl=url.match(/((?:www\.)?youtube\.com|(?:www\.)?youtube-nocookie\.com)\/watch\?v=([a-zA-Z0-9\-_]+)/),youtubeShortUrl=url.match(/(?:www\.)?youtu\.be\/([a-zA-Z0-9\-_]+)/),vimeoUrl=url.match(/(?:www\.)?vimeo\.com\/([0-9]*)/),qs="";return youtubeUrl||youtubeShortUrl?(youtubeShortUrl&&(youtubeUrl=youtubeShortUrl),qs=ui.parseUri(url,{autoplay:plugin.settings.autoplayVideos?"1":"0",v:""}),iframe='<iframe width="560" height="315" src="//'+youtubeUrl[1]+"/embed/"+youtubeUrl[2]+"?"+qs+'" frameborder="0" allowfullscreen></iframe>'):vimeoUrl?(qs=ui.parseUri(url,{autoplay:plugin.settings.autoplayVideos?"1":"0",byline:"0",portrait:"0",color:plugin.settings.vimeoColor}),iframe='<iframe width="560" height="315"  src="//player.vimeo.com/video/'+vimeoUrl[1]+"?"+qs+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>'):iframe='<iframe width="560" height="315" src="'+url+'" frameborder="0" allowfullscreen></iframe>','<div class="swipebox-video-container" style="max-width:'+plugin.settings.videoMaxWidth+'px"><div class="swipebox-video">'+iframe+"</div></div>"},loadMedia:function(src,callback){if(0===src.trim().indexOf("#"))callback.call($("<div>",{"class":"swipebox-inline-container"}).append($(src).clone().toggleClass(plugin.settings.toggleClassOnLoad)));else if(!this.isVideo(src)){var img=$("<img>").on("load",function(){callback.call(img)});img.attr("src",src)}},getNext:function(){var src,$this=this,index=$("#swipebox-slider .slide").index($("#swipebox-slider .slide.current"));index+1<elements.length?(src=$("#swipebox-slider .slide").eq(index).contents().find("iframe").attr("src"),$("#swipebox-slider .slide").eq(index).contents().find("iframe").attr("src",src),index++,$this.setSlide(index),$this.preloadMedia(index+1)):plugin.settings.loopAtEnd===!0?(src=$("#swipebox-slider .slide").eq(index).contents().find("iframe").attr("src"),$("#swipebox-slider .slide").eq(index).contents().find("iframe").attr("src",src),index=0,$this.preloadMedia(index),$this.setSlide(index),$this.preloadMedia(index+1)):($("#swipebox-overlay").addClass("rightSpring"),setTimeout(function(){$("#swipebox-overlay").removeClass("rightSpring")},500))},getPrev:function(){var src,index=$("#swipebox-slider .slide").index($("#swipebox-slider .slide.current"));index>0?(src=$("#swipebox-slider .slide").eq(index).contents().find("iframe").attr("src"),$("#swipebox-slider .slide").eq(index).contents().find("iframe").attr("src",src),index--,this.setSlide(index),this.preloadMedia(index-1)):($("#swipebox-overlay").addClass("leftSpring"),setTimeout(function(){$("#swipebox-overlay").removeClass("leftSpring")},500))},closeSlide:function(){$("html").removeClass("swipebox-html"),$("html").removeClass("swipebox-touch"),$(window).trigger("resize"),this.destroy()},destroy:function(){$(window).unbind("keyup"),$("body").unbind("touchstart"),$("body").unbind("touchmove"),$("body").unbind("touchend"),$("#swipebox-slider").unbind(),$("#swipebox-overlay").remove(),$.isArray(elem)||elem.removeData("_swipebox"),this.target&&this.target.trigger("swipebox-destroy"),$.swipebox.isOpen=!1,plugin.settings.afterClose&&plugin.settings.afterClose()}},plugin.init()},$.fn.swipebox=function(options){if(!$.data(this,"_swipebox")){var swipebox=new $.swipebox(this,options);this.data("_swipebox",swipebox)}return this.data("_swipebox")}}(window,document,jQuery);
